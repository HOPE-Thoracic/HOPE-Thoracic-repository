---
title: "Downloads"
editor: source
---

Below are all files currently available for download.




```{r}

#| label: setup-files-dir
#| include: false
#| echo: false
#| message: false
#| warning: false

# Find project root (where _quarto.yml lives)
find_root <- function() {
  p <- normalizePath(".", winslash = "/", mustWork = TRUE)
  prev <- ""
  while (!file.exists(file.path(p, "_quarto.yml")) && p != prev) {
    prev <- p
    p <- dirname(p)
  }
  p
}

proj_root <- find_root()

cand <- c(
  source = file.path(proj_root, "downloads", "files"),
  docs   = file.path(proj_root, "docs", "downloads", "files")
)

FILES_DIR <- cand[["source"]]
if (!dir.exists(FILES_DIR) && dir.exists(cand[["docs"]])) {
  FILES_DIR <- cand[["docs"]]
}

#| echo: false
#| message: false
#| warning: false

# Read files from detected directory
if (!dir.exists(FILES_DIR)) {
  cat("*(No files uploaded yet — add files to `downloads/files/` and re-render.)*")
} else {
  files <- list.files(FILES_DIR, full.names = TRUE)
  if (length(files) == 0) {
    cat("*(No files uploaded yet — check back soon.)*")
  } else {
    info  <- file.info(files)
    ord   <- order(info$mtime, decreasing = TRUE)  # newest first
    files <- files[ord]
    info  <- info[ord, ]

    names    <- basename(files)
    relpaths <- file.path("files", utils::URLencode(names, reserved = TRUE))  # link targets

    # Use HTML anchors so links are guaranteed clickable
    link_html <- sprintf('<a href="%s">%s</a>', relpaths, names)

    df <- data.frame(
      File    = link_html,
      Size_MB = round(info$size / (1024^2), 2),
      Updated = as.Date(info$mtime),
      check.names = FALSE
    )

    knitr::kable(
      df,
      format = "html",
      escape = FALSE,                          # allow the <a> tags
      table.attr = 'class="table table-striped table-sm"'
    )
  }
}

```
